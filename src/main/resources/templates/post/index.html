<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1}">

<th:block layout:fragment="css">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* 게시판 목록 스타일 */
        .post-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .post-list li {
            background-color: #f8f9fa; /* 연한 배경색 */
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* 약간의 그림자 효과 */
            transition: transform 0.3s ease; /* 마우스 오버 효과 */
        }

        .post-list li:hover {
            transform: translateY(-5px); /* 마우스 오버 시 약간 위로 올라가는 효과 */
        }

        .post-title {
            font-weight: bold;
            color: #343a40; /* 어두운 제목 색상 */
        }

        .post-content {
            color: #6c757d; /* 회색 텍스트 */
        }

        .post-actions a {
            margin-left: 10px;
            color: #007bff; /* Bootstrap 기본 링크 색상 */
            text-decoration: none;
            font-size: 14px;
        }

        .post-actions a:hover {
            text-decoration: underline; /* 링크에 호버 시 밑줄 표시 */
        }

        /* 버튼 스타일 */
        .btn-primary {
            background-color: #007bff;
            border-color: #007bff;
        }

        .btn-primary:hover {
            background-color: #0056b3;
            border-color: #0056b3;
        }

        .container {
            margin-top: 30px;
        }
    </style>

</th:block>

<th:block layout:fragment="script">
    <script th:inline="javascript">

    </script>
</th:block>

<div layout:fragment="content">
    <div class="container">
        <h1>게시글 목록</h1>
        <a href="/posts/new" class="btn btn-primary mb-3">새 게시글 작성</a>

        <form th:action="@{'/posts/' + ${posts.number}}" role="form" method="get" th:object="${posts}">
            <table class="table">
                <thead>
                <tr>
                    <th>번호</th>
                    <th>제목</th>
                    <th>작성자</th>
                    <th>작성일</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="post, status : ${posts}">
                    <td th:text="${status.count}"></td>
                    <td>
                        <a th:href="'/board/boardDtl/' + ${post.num}" th:text="${post.title}"></a>
                    </td>
                    <td th:text="${post.createBy}"></td>
                    <td th:text="${(T(java.time.LocalDateTime).now().minusHours(24).isAfter(board.regTime)) ?
                #temporals.format(post.regTime, 'yyyy-MM-dd') :
                #temporals.format(post.regTime, 'HH:mm')}"></td>
                </tr>
                </tbody>
            </table>

            <div th:with="start = ${(posts.number / maxPage) * maxPage + 1},
            end = (${(posts.totalPages == 0) ? 1 :
            (start + (maxPage - 1) < posts.totalPages ? start + (maxPage - 1) :
            posts.totalPages)})">
                <ul class="pagination justify-content-center">
                    <li class="page-item" th:classappend="${posts.first} ? 'disabled'">
                        <a th:onclick="'javascript: page(' + ${posts.number -1 } + ')'"
                           aria-label="Previous" class="page-link">
                        <span aria-hidden="true">
                            Previous
                        </span>
                        </a>
                    </li>

                    <!-- Page 객체에서 number는 현재 페이지를 나타냄. -->
                    <!-- [[${page}]]: 타임리프에서 HTML콘텐츠 영역 안에 직접 데이터를 출력할 때 사용-->
                    <!-- Page 객체에서 시작 페이지는 0부터 이므로 해당 페이지를 호출할 때에는 page -1을 함. -->
                    <li class="page-item" th:each="page: ${#numbers.sequence(start, end)}"
                        th:classappend="${posts.number eq page - 1} ? 'active' : ''">
                        <a th:onclick="'javascript:page(' +${page - 1} + ')'"
                           th:inline="text" class="page-link">[[${page}]]</a>
                    </li>

                    <li class="page-item" th:classappend="${posts.last} ? 'disabled'">
                        <a th:onclick="'javascript: page(' + ${posts.number + 1 } + ')'"
                           aria-label="Next" class="page-link">
                        <span aria-hidden="true">
                            Next
                        </span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="form-inline justify-content-center" th:object="${postSearchDTO}">
                <select th:field="*{searchDateType}" class="form-control" style="width:auto;"
                        id="searchDateType">
                    <option value="all">전체기간</option>
                    <option value="1d">1일</option>
                    <option value="1w">1주</option>
                    <option value="1m">1개월</option>
                    <option value="6m">6개월</option>
                </select>
                <select th:field="*{searchBy}" class="form-control" style="width:auto;" id="searchBy">
                    <option value="title">제목</option>
                    <option value="createBy">등록자</option>
                </select>
                <input th:field="*{searchQuery}" class="form-control" placeholder="검색어를 입력해주세요."
                       id="searchQuery">
                <button id="searchBtn" type="submit" class="btn btn-primary">검색</button>
            </div>
        </form>

    </div>
</html>