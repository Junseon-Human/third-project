<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1}">

<th:block layout:fragment="css">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* 슬라이드 이미지 크기 조정 */
        .carousel-item img {
            max-height: 400px; /* 이미지의 최대 높이를 설정 */
            width: 100%; /* 너비는 슬라이드에 맞게 설정 */
            object-fit: contain; /* 이미지 비율을 유지하며 잘리지 않도록 설정 */
            object-position: center; /* 이미지 중앙에 배치 */
        }

        .carousel-caption {
            background-color: rgba(0, 0, 0, 0.5); /* 텍스트 가독성을 위한 반투명 배경 */
            padding: 10px;
        }

        /* 슬라이드 버튼 크기 및 색상 조정 */
        .carousel-control-prev-icon,
        .carousel-control-next-icon {
            background-color: rgba(50, 50, 50, 0.5); /* 버튼을 진한 회색으로 설정 */
            width: 40px;
            height: 40px;
            border-radius: 50%; /* 버튼을 동그랗게 설정 */
        }

        /* 주목할만한 전시회, 금주의 전시회 제목에 Noto Sans 적용 */
        .section-title {
            font-family: 'Noto Sans', sans-serif;
            font-size: 32px;
            font-weight: 700;
            text-align: left; /* 왼쪽 정렬 */
            margin-left: 20px; /* 왼쪽에 여백을 추가 */
            margin-bottom: 30px;
        }

        /* 금주의 전시회 날짜 빨간색으로 설정 */
        .exhibition-date {
            font-size: 0.9rem;
            color: gray; /* 날짜를 빨간색으로 설정 */
        }

        /* 포스터 스타일 및 크기 */
        .exhibition-item {
            margin-bottom: 30px;
        }

        .exhibition-item img {
            width: 100%;
            height: 350px; /* 고정된 포스터 크기 */
            object-fit: cover;
            border-radius: 10px;
        }

        .exhibition-title {
            font-size: 1.25rem;
            font-weight: bold;
            margin-top: 10px;
        }

        .exhibition-venue {
            font-size: 1rem;
            color: #666;
            margin-bottom: 5px;
        }

        .poster-wrapper {
            width: 100%;
            max-width: 250px;
            margin: 0 auto;
            text-align: center;
        }

        /* 장르별 랭킹 스타일 */
        .genre-filter {
            margin-bottom: 30px;
            text-align: left;
            margin-left: 20px;
        }

        .genre-filter button {
            margin-right: 10px;
            font-size: 16px;
        }

    </style>
</th:block>

<th:block layout:fragment="script">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        function filterRankings(genre) {
            // 모든 카드를 숨기고, 선택한 장르에 맞는 카드만 보이게 함
            $('.col-lg-2').hide();
            if (genre === 'all') {
                $('.col-lg-2').show();
            } else {
                $('.col-lg-2[th\\:if*="' + genre + '"]').show();
            }

            // 필터 버튼 활성화 처리
            $('.genre-filter button').removeClass('active');
            $('button[th\\:onclick*="' + genre + '"]').addClass('active');
        }

        // 페이지 로드 시 모든 항목 표시
        $(document).ready(function() {
            filterRankings('all');
        });
    </script>
</th:block>

<div layout:fragment="content">
    <div class="container mt-5">
        <!-- 주목할만한 전시회 타이틀 (왼쪽 정렬) -->
        <h1 class="section-title">주목할만한 전시회</h1>

        <!-- 슬라이드 영역 -->
        <div id="exhibitionCarousel" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner">
                <th:block th:each="exhibition, stat : ${exhibitionList}">
                    <div class="carousel-item" th:classappend="${stat.index == 0} ? 'active'">
                        <img th:src="${exhibition.poster}" alt="Exhibition Poster">
                        <div class="carousel-caption d-none d-md-block">
                            <h5 th:text="${exhibition.prfnm}">Exhibition Title</h5>
                            <p th:text="'상영 날짜: ' + ${exhibition.prfpdfrom} + ' ~ ' + ${exhibition.prfpdto}">상영 날짜</p>
                        </div>
                    </div>
                </th:block>
            </div>

            <!-- 슬라이드 이동 버튼 -->
            <a class="carousel-control-prev" href="#exhibitionCarousel" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#exhibitionCarousel" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>

        <!-- 금주의 전시회 영역 -->
        <div class="weekly-exhibition mt-5">
            <h1 class="section-title">금주의 전시회</h1>
            <div class="row">
                <!-- 4행 4열로 포스터 및 공연 날짜 표시 -->
                <th:block th:each="exhibition, stat : ${exhibitionList}">
                    <div class="col-lg-3 col-md-4 col-sm-6 exhibition-item">
                        <div class="poster-wrapper">
                            <img th:src="${exhibition.poster}" class="poster-img" alt="Exhibition Poster">
                            <div class="exhibition-title" th:text="${exhibition.prfnm}">뮤지컬 &lt;제목&gt;</div>
                            <div class="exhibition-fcltynm" th:text="${exhibition.fcltynm}">장소</div>
                            <div class="exhibition-date" th:text="${exhibition.prfpdfrom} + ' ~ ' + ${exhibition.prfpdto}"></div>
                        </div>
                    </div>
                </th:block>
            </div>
        </div>

        <!-- 장르별 랭킹 영역 -->
        <div class="genre-exhibition mt-5">
            <h1 class="section-title">장르별 랭킹</h1>
            <div class="genre-filter">
                <button class="btn btn-outline-dark active" th:onclick="|filterRankings('all')|">전체보기</button>
                <button class="btn btn-outline-dark" th:onclick="|filterRankings('뮤지컬')|">뮤지컬</button>
                <button class="btn btn-outline-dark" th:onclick="|filterRankings('연극')|">연극</button>
                <button class="btn btn-outline-dark" th:onclick="|filterRankings('무용')|">무용</button>
                <button class="btn btn-outline-dark" th:onclick="|filterRankings('한국음악')|">한국음악</button>
                <button class="btn btn-outline-dark" th:onclick="|filterRankings('서양음악')|">서양음악</button>
                <button class="btn btn-outline-dark" th:onclick="|filterRankings('대중음악')|">대중음악</button>
            </div>
            <div class="row">
                <!-- 5열로 포스터 및 공연 날짜 표시 -->
                <th:block th:each="ranking, stat : ${exhibitionList}">
                    <div class="col-lg-2 col-md-4 col-sm-6 exhibition-item" th:if="${ranking.genre == 'all' || ranking.genre == currentGenre}">
                        <div class="poster-wrapper">
                            <img th:src="${ranking.poster}" class="poster-img" alt="Ranking Poster">
                            <div class="exhibition-title" th:text="${ranking.title}">뮤지컬 &lt;제목&gt;</div>
                            <div class="exhibition-venue" th:text="${ranking.fcltynm}">장소</div>
                            <div class="exhibition-date" th:text="${ranking.prfpdfrom} + ' ~ ' + ${ranking.prfpdto}"></div>
                        </div>
                    </div>
                </th:block>
            </div>
        </div>
    </div>
</div>
</html>
