<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1}">

<th:block layout:fragment="css">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* 슬라이드 이미지 크기 조정 */
        .carousel-item img {
            max-height: 400px; /* 이미지의 최대 높이를 설정 */
            width: 100%; /* 너비는 슬라이드에 맞게 설정 */
            object-fit: contain; /* 이미지 비율을 유지하며 잘리지 않도록 설정 */
            object-position: center; /* 이미지 중앙에 배치 */
        }

        .carousel-caption {
            background-color: rgba(0, 0, 0, 0.5); /* 텍스트 가독성을 위한 반투명 배경 */
            padding: 10px;
        }

        /* 슬라이드 버튼 크기 및 색상 조정 */
        .carousel-control-prev-icon,
        .carousel-control-next-icon {
            background-color: rgba(50, 50, 50, 0.5); /* 버튼을 진한 회색으로 설정 */
            width: 40px;
            height: 40px;
            border-radius: 50%; /* 버튼을 동그랗게 설정 */
        }

        /* 주목할만한 전시회, 금주의 전시회 제목에 Noto Sans 적용 */
        .section-title {
            font-family: 'Noto Sans', sans-serif;
            font-size: 32px;
            font-weight: 700;
            text-align: left; /* 왼쪽 정렬 */
            margin-left: 20px; /* 왼쪽에 여백을 추가 */
            margin-bottom: 30px;
        }

        /* 금주의 전시회 날짜 색상 설정 */
        .exhibition-date {
            font-size: 0.9rem;
            color: gray;
        }

        /* 포스터 스타일 및 크기 */
        .exhibition-item {
            margin-bottom: 30px;
        }

        /* 링크 기본 스타일 제거 */
        .exhibition-item a {
            text-decoration: none; /* 기본 밑줄 제거 */
            color: inherit; /* 기본 파란색 제거, 텍스트 상속된 색상 사용 */
        }

        .exhibition-item a:hover {
            text-decoration: none; /* 호버 시에도 밑줄 제거 */
        }

        .exhibition-item img {
            width: 100%;
            height: 350px; /* 고정된 포스터 크기 */
            object-fit: cover;
            border-radius: 10px;
            transition: transform 0.3s ease; /* 호버 애니메이션 추가 */
        }

        .exhibition-item img:hover {
            transform: scale(1.05); /* 호버 시 이미지 커짐 */
        }

        .exhibition-title {
            font-size: 1.25rem;
            font-weight: bold;
            margin-top: 10px;
        }

        .exhibition-venue {
            font-size: 1rem;
            color: #666;
            margin-bottom: 5px;
        }

        .poster-wrapper {
            width: 100%;
            max-width: 250px;
            margin: 0 auto;
            text-align: center;
        }

        /* 장르별 랭킹 스타일 */
        .genre-filter {
            margin-bottom: 30px;
            text-align: left;
            margin-left: 20px;
        }

        .genre-filter button {
            margin-right: 10px;
            font-size: 16px;
        }

        /* 버튼 활성화 시 스타일 */
        .btn-active {
            background-color: black;
            color: white;
        }

    </style>
</th:block>

<th:block layout:fragment="script">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        // 필터링 기능
        let currentGenre = 'all';  // 기본값 '전체보기'
        function filterRankings(genre) {
            currentGenre = genre;

            // 장르별 필터링
            document.querySelectorAll('.exhibition-item').forEach(item => {
                const itemGenre = item.getAttribute('data-genre');
                if (genre === 'all' || itemGenre === genre) {
                    item.style.display = 'block';  // 해당 장르일 경우 보임
                } else {
                    item.style.display = 'none';  // 해당 장르가 아니면 숨김
                }
            });

            document.querySelectorAll('.genre-filter a').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('.genre-filter a').forEach(btn => btn.classList.remove('btn-active'));
                    this.classList.add('btn-active');
                });
            });

        }
    </script>
</th:block>

<div layout:fragment="content">
    <div class="container mt-5">
        <!-- 주목할만한 전시회 타이틀 (왼쪽 정렬) -->
        <h1 class="section-title">주목할만한 전시회</h1>

        <!-- 슬라이드 영역 -->
        <div id="exhibitionCarousel" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner">
                <th:block th:each="exhibition, stat : ${exhibitionList}">
                    <div class="carousel-item" th:classappend="${stat.index == 0} ? 'active'">
                        <a th:href="'/show/'+${exhibition.mt20id}">
                            <img th:src="${exhibition.poster}" alt="Exhibition Poster">
                        </a>
                        <div class="carousel-caption d-none d-md-block">
                            <h5 th:text="${exhibition.prfnm}">Exhibition Title</h5>
                            <p th:text="${exhibition.prfpdfrom} + ' ~ ' + ${exhibition.prfpdto}">상영 날짜</p>
                        </div>
                    </div>
                </th:block>
            </div>

            <!-- 슬라이드 이동 버튼 -->
            <a class="carousel-control-prev" href="#exhibitionCarousel" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#exhibitionCarousel" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>

        <!-- 금주의 전시회 영역 -->
        <div class="weekly-exhibition mt-5">
            <h1 class="section-title">금주의 전시회</h1>
            <div class="row">
                <!-- 4행 4열로 포스터 및 공연 날짜 표시 -->
                <th:block th:each="exhibition, stat : ${exhibitionList}">
                    <div class="col-lg-3 col-md-4 col-sm-6 exhibition-item">
                        <a th:href="'/show/'+${exhibition.mt20id}">
                            <div class="poster-wrapper">
                                <img th:src="${exhibition.poster}" class="poster-img" alt="Exhibition Poster">
                                <div class="exhibition-title" th:text="${exhibition.prfnm}">뮤지컬 &lt;제목&gt;</div>
                                <div class="exhibition-venue" th:text="${exhibition.fcltynm}">장소</div>
                                <div class="exhibition-date" th:text="${exhibition.prfpdfrom} + ' ~ ' + ${exhibition.prfpdto}"></div>
                            </div>
                        </a>
                    </div>
                </th:block>
            </div>
        </div>

        <!-- 장르별 랭킹 영역 -->
        <div class="genre-exhibition mt-5">
            <h1 class="section-title">장르별 랭킹</h1>
            <!-- 장르별 랭킹 영역 (장르별 버튼과 URL 연결) -->
            <div class="genre-filter">
                <a th:href="@{/exhibitions/genre/MUSICAL}" class="btn btn-outline-dark">뮤지컬</a>
                <a th:href="@{/exhibitions/genre/CONCERT}" class="btn btn-outline-dark">콘서트</a>
                <a th:href="@{/exhibitions/genre/PLAY}" class="btn btn-outline-dark">연극</a>
                <a th:href="@{/exhibitions/genre/EXHIBITION}" class="btn btn-outline-dark">전시</a>
                <!-- 추가로 필요한 장르 버튼들 -->
            </div>
            <div class="row">
                <!-- 5열로 포스터 및 공연 날짜 표시 -->
                <th:block th:each="ranking, stat : ${rankingList}">
                    <div class="col-lg-2 col-md-4 col-sm-6 exhibition-item" th:data-genre="${ranking.genrenm}">
                        <a th:href="'/show/'+${ranking.mt20id}">
                            <div class="poster-wrapper">
                                <img th:src="${ranking.poster}" class="poster-img" alt="Ranking Poster">
                                <div class="exhibition-title" th:text="${ranking.prfnm}">뮤지컬 &lt;제목&gt;</div>
                                <div class="exhibition-venue" th:text="${ranking.fcltynm}">장소</div>
                                <div class="exhibition-date" th:text="${ranking.prfpdfrom} + ' ~ ' + ${ranking.prfpdto}"></div>
                            </div>
                        </a>
                    </div>
                </th:block>
            </div>

        </div>
    </div>
</div>
</html>
