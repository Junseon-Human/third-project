<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1}">

<th:block layout:fragment="css">
    <style>
        /* 슬라이드 이미지 크기 조정 */
        .carousel-item img {
            max-height: 400px; /* 이미지의 최대 높이를 설정 */
            width: 100%; /* 너비는 슬라이드에 맞게 설정 */
            object-fit: contain; /* 이미지 비율을 유지하며 잘리지 않도록 설정 */
            object-position: center; /* 이미지 중앙에 배치 */
        }

        .carousel-caption {
            background-color: rgba(0, 0, 0, 0.5); /* 텍스트 가독성을 위한 반투명 배경 */
            padding: 10px;
        }

        /* 슬라이드 버튼 크기 및 색상 조정 */
        .carousel-control-prev-icon,
        .carousel-control-next-icon {
            background-color: rgba(50, 50, 50, 0.5); /* 버튼을 진한 회색으로 설정 */
            width: 40px;
            height: 40px;
            border-radius: 50%; /* 버튼을 동그랗게 설정 */
        }

        /* 주목할만한 전시회, 금주의 전시회 제목에 Noto Sans 적용 */
        .section-title {
            font-family: 'Noto Sans', sans-serif;
            font-size: 32px;
            font-weight: 700;
            text-align: left; /* 왼쪽 정렬 */
            margin-left: 20px; /* 왼쪽에 여백을 추가 */
            margin-bottom: 30px;
        }

        /* 금주의 전시회 날짜 색상 설정 */
        .exhibition-date {
            font-size: 0.9rem;
            color: gray;
        }

        /* 포스터 스타일 및 크기 */
        .exhibition-item {
            margin-bottom: 30px;
        }

        /* 링크 기본 스타일 제거 */
        .exhibition-item a {
            text-decoration: none; /* 기본 밑줄 제거 */
            color: inherit; /* 기본 파란색 제거, 텍스트 상속된 색상 사용 */
        }

        .exhibition-item a:hover {
            text-decoration: none; /* 호버 시에도 밑줄 제거 */
        }

        .exhibition-item img {
            width: 100%;
            height: 350px; /* 고정된 포스터 크기 */
            object-fit: cover;
            border-radius: 10px;
            transition: transform 0.3s ease; /* 호버 애니메이션 추가 */
        }

        .exhibition-item img:hover {
            transform: scale(1.05); /* 호버 시 이미지 커짐 */
        }

        .exhibition-title {
            font-size: 1.25rem;
            font-weight: bold;
            margin-top: 10px;
        }

        .exhibition-venue {
            font-size: 1rem;
            color: #666;
            margin-bottom: 5px;
        }

        .poster-wrapper {
            width: 100%;
            max-width: 250px;
            margin: 0 auto;
            text-align: center;
        }

        /* 장르별 랭킹 스타일 */
        .genre-filter {
            margin-bottom: 30px;
            text-align: left;
            margin-left: 20px;
        }

        .genre-filter button {
            margin-right: 10px;
            font-size: 16px;
        }

        /* 버튼 활성화 시 스타일 */
        .btn-active {
            background-color: black;
            color: white;
        }

    </style>
</th:block>

<th:block layout:fragment="script">
    <script>
        function fetchShowsByGenre(genre) {
            $.ajax({
                url: '/genreFilter', // 서버에서 데이터를 가져올 URL
                type: 'GET',
                data: { genre: genre }, // 장르를 쿼리 파라미터로 전달
                success: function(data) {
                    $('#shows-container').empty(); // 기존 내용을 비우기
                    $('#shows-container').append(data); // 새로운 데이터를 추가
                },
                error: function(xhr, status, error) {
                    console.error("AJAX Error: " + status + error);
                }
            });
        }


    </script>
</th:block>

<div layout:fragment="content">
    <div class="container mt-5">
        <h1 class="section-title">주목할만한 전시회</h1>
        <div id="exhibitionCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                <th:block th:each="exhibition, stat : ${exhibitionList}">
                    <div class="carousel-item" th:class="${stat.index == 0} ? 'carousel-item active' : 'carousel-item'">
                        <a th:href="'/show/'+${exhibition.mt20id}">
                            <img th:src="${exhibition.poster}" alt="Exhibition Poster">
                        </a>
                        <div class="carousel-caption d-none d-md-block">
                            <h5 th:text="${exhibition.prfnm}">Exhibition Title</h5>
                            <p th:text="|${exhibition.prfpdfrom} ~ ${exhibition.prfpdto}|">상영 날짜</p>
                        </div>
                    </div>
                </th:block>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#exhibitionCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#exhibitionCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
        <div class="weekly-exhibition mt-5">
            <h1 class="section-title">금주의 전시회</h1>
            <div class="row">
                <th:block th:each="exhibition : ${exhibitionList}">
                    <div class="col-lg-3 col-md-4 col-sm-6 exhibition-item">
                        <a th:href="'/show/'+${exhibition.mt20id}">
                            <div class="poster-wrapper">
                                <img th:src="${exhibition.poster}" class="poster-img" alt="Exhibition Poster">
                                <div class="exhibition-title" th:text="${exhibition.prfnm}">뮤지컬 &lt;제목&gt;</div>
                                <div class="exhibition-venue" th:text="${exhibition.fcltynm}">장소</div>
                                <div class="exhibition-date"
                                     th:text="|${exhibition.prfpdfrom} ~ ${exhibition.prfpdto}|"></div>
                            </div>
                        </a>
                    </div>
                </th:block>
            </div>
        </div>
        <div>
            <h1>장르별 랭킹</h1>
            <button onclick="fetchShowsByGenre('POPULAR_MUSIC')">대중음악</button>
            <button onclick="fetchShowsByGenre('CLASSIC')">클래식</button>
            <button onclick="fetchShowsByGenre('GUGAK')">국악</button>
            <button onclick="fetchShowsByGenre('ACT')">연극</button>
            <button onclick="fetchShowsByGenre('MUSICAL')">뮤지컬</button>
            <button onclick="fetchShowsByGenre('CIRCUS_MAGIC')">서커스/마술</button>
            <button onclick="fetchShowsByGenre('COMPLEX')">복합</button>
            <button onclick="fetchShowsByGenre('DANCE')">무용</button>
            <div class="row" id="shows-container">
                <th:block th:each="exhibition, iterStat : ${showList}">
                            <div class="col-lg-3 col-md-4 col-sm-6 exhibition-item">
                                <a th:href="'/show/'+${exhibition.mt20id}">
                                    <div class="poster-wrapper">
                                        <img th:src="${exhibition.poster}" class="poster-img" alt="Exhibition Poster">
                                        <div class="exhibition-title" th:text="${exhibition.prfnm}">댄스 &lt;제목&gt;</div>
                                        <div class="exhibition-date"
                                             th:text="|${exhibition.prfpdfrom} ~ ${exhibition.prfpdto}|"></div>
                                        <div class="exhibition-genre"
                                             th:text="${exhibition.getGenrenm()}"></div>
                                    </div>
                                </a>
                            </div>
                </th:block>
            </div>
        </div>
    </div>
</div>

</html>
